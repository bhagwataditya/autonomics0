% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analyze_contrasts.R, R/analyze_eset.R
\name{analyze_contrasts}
\alias{analyze_contrasts}
\alias{analyze_eset}
\title{Analyze eset with omics data}
\usage{
analyze_contrasts(object, result_dir = default_result_dir(object),
  design = autonomics.find::create_design_matrix(object),
  contrasts = autonomics.find::default_contrasts(object),
  top_definition = autonomics.find::default_top_definition(object),
  universe = autonomics.ora::default_universe(object),
  feature_plots = autonomics.plot::default_feature_plots(object),
  x = autonomics.plot::default_x(object, feature_plots[1]),
  color_var = autonomics.plot::default_color_var(object),
  color_values = autonomics.plot::default_color_values(object, color_var),
  shape_var = autonomics.plot::default_shape_var(object),
  group_var = autonomics.plot::default_group_var(object),
  facet_var = autonomics.plot::default_facet_var(),
  line = autonomics.plot::default_line(object),
  fvars = autonomics.plot::default_fvars(object),
  cluster_features = autonomics::default_cluster_features(),
  nplot = autonomics.find::default_nplot(object), feature_plot_width = NULL,
  feature_plot_height = NULL, min_set_size = 5, max_set_size = Inf)

analyze_eset(object, result_dir = default_result_dir(object),
  design = autonomics.find::create_design_matrix(object),
  contrasts = autonomics.find::default_contrasts(object),
  top_definition = autonomics.find::default_top_definition(object),
  universe = autonomics.ora::default_universe(object),
  feature_plots = autonomics.plot::default_feature_plots(object),
  x = autonomics.plot::default_x(object, feature_plots),
  color_var = autonomics.plot::default_color_var(object),
  color_values = autonomics.plot::default_color_values(object),
  shape_var = autonomics.plot::default_shape_var(object),
  group_var = autonomics.plot::default_group_var(object),
  txt_var = autonomics.plot::default_txt_var(object),
  facet_var = autonomics.plot::default_facet_var(),
  line = autonomics.plot::default_line(object),
  fvars = autonomics.plot::default_fvars(object), do_pca = TRUE,
  cluster_features = default_cluster_features(),
  nplot = autonomics.find::default_nplot(object), feature_plot_width = NULL,
  feature_plot_height = NULL, min_set_size = 5, max_set_size = Inf,
  zip_results = FALSE)
}
\arguments{
\item{object}{eset}

\item{result_dir}{directory to which to write results}

\item{design}{design matrix}

\item{contrasts}{contrast definitions}

\item{top_definition}{Definition of 'top features'.}

\item{universe}{'detectome', 'genome', or NULL (no ora)}

\item{feature_plots}{subset of c('bars', 'profiles', 'distributions')}

\item{x}{svar mapped to x in feature plots}

\item{color_var}{svar mapped to color in feature plots}

\item{color_values}{color values vector}

\item{shape_var}{svar mapped to shape in feature plots}

\item{group_var}{svar mapped to group in feature plots}

\item{facet_var}{svar used to facet feature plots}

\item{line}{whether to join points in feature plot with line (logical)}

\item{fvars}{fvars to use in plot annotation}

\item{cluster_features}{whether to cluster features (logical)}

\item{nplot}{no of top features to be plotted}

\item{feature_plot_width}{in inches}

\item{feature_plot_height}{in inches}

\item{min_set_size}{min set size (for ora)}

\item{max_set_size}{max set size (for ora)}

\item{txt_var}{svar mapped to txt in PCA plots (but not in feature plots!)}

\item{do_pca}{whether to perform PCA analysis (logical)}

\item{zip_results}{zip analysis results (logical)?}
}
\value{
eset with analysis results in fdata
}
\description{
\enumerate{
  \item Sample normalization
  \item Principal component analysis
  \item General linear model based contrast analysis (see details)
  \item Gene Set Over representation analysis
}
\cr
}
\details{
The data is analyzed with the model "~ 0 + subgroup", which fits a separate coefficient for each subgroup level.
Each element in the contrast vector can contain any linear combination of the model coefficients.
\itemize{
  \item the coefficients themselves:      contrasts = c('A', 'B', 'C')
  \item differences between coefficients: contrasts = c('A-B', 'A-C', 'B-C')
  \item the mean of all coefficients:     contrasts = c('(A + B + C)/3')
  \item or a combination of the previous types: contrasts = c('A', 'B', 'C', 'A-B', 'B-C', 'A-C', '(A+B+C)/3')
}
See the examples for more details
}
\examples{

require(magrittr)
# Compare each subgroup level to zero
#------------------------------------
if (require(autonomics.data)){
   result_dir <- tempdir() \%>\% paste0('/analysis.results') \%T>\% message()
   dir.create(result_dir, showWarnings = FALSE)
   object <- autonomics.data::billing2016
   unique(object$subgroup)
   object \%>\% autonomics::analyze_eset(result_dir, universe = NULL)
}

# Differences between subgroup levels
#------------------------------------
if (require(billing.differentiation.data)){
   result_dir <- tempdir() \%>\% paste0('/analysis.results') \%T>\% message()
   dir.create(result_dir, showWarnings = FALSE)
   autonomics::analyze_eset(
      object   = billing.differentiation.data::protein.ratios,
      result_dir = result_dir,
      # contrasts  = billing.differentiation.data::contrasts[10],
      universe   = NULL)

   autonomics::analyze_contrasts(
      object   = billing.differentiation.data::rna.voomcounts,
      result_dir = result_dir,
      contrasts  = billing.differentiation.data::contrasts[1:2],
      universe   = NULL)
}

# Commonalities across subgroup levels
#-------------------------------------
if (require(atkin.2014)){
   require(magrittr)
   result_dir <- tempdir() \%>\% paste0('/analysis.results') \%T>\% message()
   dir.create(result_dir, showWarnings = FALSE)
   object <- atkin.2014::soma
   contrasts <- atkin.2014::contrasts[1]
   object$subgroup \%>\% unique()
   object \%>\% autonomics::analyze_eset(
                   contrasts = contrasts, result_dir = result_dir, universe = NULL)
}

# Metabolon data
#---------------
if (require(subramanian.2016)){
   require(magrittr)
   result_dir <- tempdir() \%>\% paste0('/analysis.results') \%T>\% message()
   dir.create(result_dir, showWarnings = FALSE)
   object <- subramanian.2016::metabolon
   contrasts <- subramanian.2016::contrasts.metabolon[1]
   object \%>\% autonomics::analyze_eset(
                   contrasts = contrasts, result_dir = result_dir,
                   color_var = 'condition', group_var = 'condition', line = TRUE)
}
}
