% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analyze_contrasts.R, R/analyze_eset.R
\name{analyze_contrasts}
\alias{analyze_contrasts}
\alias{analyze_eset}
\title{Analyze SummarizeExperiment}
\usage{
analyze_contrasts(object, result_dir = default_result_dir(object),
  design = autonomics.find::create_design_matrix(object),
  contrasts = autonomics.find::default_contrasts(object),
  direction = c("neg", "pos"),
  top_definition = autonomics.find::default_top_definition(object),
  universe = autonomics.ora::default_universe(object),
  cluster_features = autonomics::default_cluster_features(),
  nplot = autonomics.find::default_nplot(object), feature_plot_width = NULL,
  feature_plot_height = NULL, min_set_size = 5, max_set_size = Inf, ...)

analyze_eset(object, result_dir = default_result_dir(object),
  design = autonomics.find::create_design_matrix(object),
  contrasts = autonomics.find::default_contrasts(object),
  top_definition = autonomics.find::default_top_definition(object),
  universe = autonomics.ora::default_universe(object), dodge_width = 0,
  do_pca = TRUE, cluster_features = default_cluster_features(),
  nplot = autonomics.find::default_nplot(object), feature_plot_width = NULL,
  feature_plot_height = NULL, min_set_size = 5, max_set_size = Inf,
  zip_results = FALSE, ...)
}
\arguments{
\item{object}{SummarizedExperiment}

\item{result_dir}{directory to which to write results}

\item{design}{design matrix}

\item{contrasts}{contrast definitions}

\item{top_definition}{Definition of 'top features'.}

\item{universe}{'detectome', 'genome', or NULL (no ora)}

\item{cluster_features}{whether to cluster features (logical)}

\item{nplot}{no of top features to be plotted}

\item{feature_plot_width}{in inches}

\item{feature_plot_height}{in inches}

\item{min_set_size}{min set size (for ora)}

\item{max_set_size}{max set size (for ora)}

\item{...}{passed to autonomics.plot::plot_features(...)}

\item{do_pca}{whether to perform PCA analysis (logical)}

\item{zip_results}{zip analysis results (logical)?}
}
\value{
Updated SummarizedExperiment
}
\description{
\enumerate{
  \item Sample normalization
  \item Principal component analysis
  \item General linear model based contrast analysis (see details)
  \item Gene Set Over representation analysis
}
\cr
}
\details{
The data is analyzed with the model "~ 0 + subgroup", which fits a separate coefficient for each subgroup level.
Each element in the contrast vector can contain any linear combination of the model coefficients.
\itemize{
  \item the coefficients themselves:      contrasts = c('A', 'B', 'C')
  \item differences between coefficients: contrasts = c('A-B', 'A-C', 'B-C')
  \item the mean of all coefficients:     contrasts = c('(A + B + C)/3')
  \item or a combination of the previous types: contrasts = c('A', 'B', 'C', 'A-B', 'B-C', 'A-C', '(A+B+C)/3')
}
See the examples for more details
}
\examples{

require(magrittr)
# Compare each subgroup level to zero
#------------------------------------
if (require(autonomics.data)){
   result_dir <- tempdir() \%>\% paste0('/analysis.results') \%T>\% message()
   dir.create(result_dir, showWarnings = FALSE)
   object <- autonomics.data::billing2016
   unique(object$subgroup)
   object \%>\% autonomics::analyze_eset(result_dir, universe = NULL)
}

# Differences between subgroup levels
#------------------------------------
if (require(billing.differentiation.data)){
   result_dir <- tempdir() \%>\% paste0('/analysis.results') \%T>\% message()
   dir.create(result_dir, showWarnings = FALSE)
   autonomics::analyze_eset(
      object   = billing.differentiation.data::protein.ratios,
      result_dir = result_dir,
      # contrasts  = billing.differentiation.data::contrasts[10],
      universe   = NULL)

   autonomics::analyze_contrasts(
      object   = billing.differentiation.data::rna.voomcounts,
      result_dir = result_dir,
      contrasts  = billing.differentiation.data::contrasts[1:2],
      universe   = NULL)
}

# Commonalities across subgroup levels
#-------------------------------------
if (require(atkin.2014)){
   require(magrittr)
   result_dir <- tempdir() \%>\% paste0('/analysis.results') \%T>\% message()
   dir.create(result_dir, showWarnings = FALSE)
   object <- atkin.2014::soma
   contrasts <- atkin.2014::contrasts[1]
   object$subgroup \%>\% unique()
   object \%>\% autonomics::analyze_eset(
                   contrasts = contrasts, result_dir = result_dir, universe = NULL)
}

# Metabolon data
#---------------
if (require(subramanian.2016)){
   require(magrittr)
   result_dir <- tempdir() \%>\% paste0('/analysis.results') \%T>\% message()
   dir.create(result_dir, showWarnings = FALSE)
   object <- subramanian.2016::metabolon
   contrasts <- subramanian.2016::contrasts.metabolon[1]
   object \%>\% autonomics::analyze_eset(
                   contrasts = contrasts, result_dir = result_dir,
                   color_var = 'condition', group_var = 'condition', line = TRUE)
}
}
